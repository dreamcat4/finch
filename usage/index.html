<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Finch - Usage</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Dreamcat4">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- google_prettify/sons-of-obsidian.css -->
    <!-- google_prettify/desert.css -->
    <!-- google_prettify/sunburst.css -->
    <!-- google_prettify/twitter-bootstrap.css -->
    <!-- google_prettify/default.css -->

<link href='/finch/assets/stylesheets/bootstrap.min-5534befd4bd1fd0a071242cecfe33975.css' type='text/css' rel='stylesheet' media='all'>
<link href='/finch/assets/stylesheets/poole-3c3695b40c100cdb0e4db7753b840b57.css' type='text/css' rel='stylesheet' media='all'>
<link href='/finch/assets/stylesheets/style-cf56b256a9bd3b065ef200cb5c12edb6.css' type='text/css' rel='stylesheet' media='all'>
<link href='/finch/assets/stylesheets/google_prettify/default-twitter-merge-fba10b1d8b0c64b52b9995d391059367.css' type='text/css' rel='stylesheet' media='all'>
    <!-- Favicon and touch icons -->
    <link rel="shortcut icon" href="/finch/assets/media/favicon.ico">
    <!-- <link rel="apple-touch-icon" href="media/apple-touch-icon.png"> -->
    <!-- <link rel="apple-touch-icon" sizes="72x72" href="media/apple-touch-icon-72x72.png"> -->
    <!-- <link rel="apple-touch-icon" sizes="114x114" href="media/apple-touch-icon-114x114.png"> -->
 
  </head>

  <body class="theme-base-08">

    <div class="sidebar">
      <div class="container sidebar-sticky">
    
        <div class="sidebar-about">
    
              <h1 style="margin-bottom: -10px;">
                <a class="sidebar-nav-item" href="/finch">Finch</a>
              </h1>
    
          <!-- <p class="lead">FreeBSD... in a chroot!</p> -->
    
          <p class="lead">Freebsd... <strong><i>in a chroot!</i></strong></p>
          <!-- <p class="lead">Freebsd <strong><i>in a chroot!</i></strong></p> -->
    
          <!-- <div class="lead">Freebsd... <strong></div>
            <div class="lead"><i>&nbsp&nbsp&nbsp&nbsp&nbspin a chroot!</i></strong></div> -->
    
        </div>
    
        <ul class="sidebar-nav">
    
                <li class="sidebar-nav-item"><a href="/finch/install">Install</a></li>
                <li>
                  <a href="/finch/usage" class="sidebar-nav-item-active">Usage</a>
                </li>
                <li class="sidebar-nav-item"><a href="/finch/manpage">Manpage</a></li>
                <li class="sidebar-nav-item"><a href="/finch/faq">FAQ</a></li>
                <li class="sidebar-nav-item"><a href="/finch/jails-how-to">Jails How To</a></li>
                <li class="sidebar-nav-item"><a href="/finch/jails-ip-addresses">Jails Ip Addresses</a></li>
                <li class="sidebar-nav-item"><a href="/finch/jails-ssh">Jails Ssh</a></li>
                <li class="sidebar-nav-item"><a href="/finch/mounting-filesystems">Mounting Filesystems</a></li>
                <li class="sidebar-nav-item"><a href="/finch/qjail-reference">Qjail Reference</a></li>
                <li class="sidebar-nav-item"><a href="/finch/upgrading">Upgrading</a></li>
                <li class="sidebar-nav-item"><a href="/finch/support">Support</a></li>
    
              <!-- <li><a href="/finch/faq">FAQ</a></li> -->
              <!-- <li class="sidebar-nav-item"><a href="/finch/faq">FAQ</a></li> -->
              <!-- <li><a href="/finch/finch-8">Finch 8</a></li> -->
              <!-- <li class="sidebar-nav-item"><a href="/finch/finch-8">Finch 8</a></li> -->
              <!-- <li><a href="/finch">Index</a></li> -->
              <!-- <li class="sidebar-nav-item"><a href="/finch">Index</a></li> -->
              <!-- <li><a href="/finch/install">Install</a></li> -->
              <!-- <li class="sidebar-nav-item"><a href="/finch/install">Install</a></li> -->
              <!-- <li><a href="/finch/jails-how-to">Jails How To</a></li> -->
              <!-- <li class="sidebar-nav-item"><a href="/finch/jails-how-to">Jails How To</a></li> -->
              <!-- <li><a href="/finch/jails-ip-addresses">Jails Ip Addresses</a></li> -->
              <!-- <li class="sidebar-nav-item"><a href="/finch/jails-ip-addresses">Jails Ip Addresses</a></li> -->
              <!-- <li><a href="/finch/jails-ssh">Jails Ssh</a></li> -->
              <!-- <li class="sidebar-nav-item"><a href="/finch/jails-ssh">Jails Ssh</a></li> -->
              <!-- <li><a href="/finch/manpage">Manpage</a></li> -->
              <!-- <li class="sidebar-nav-item"><a href="/finch/manpage">Manpage</a></li> -->
              <!-- <li><a href="/finch/mounting-filesystems">Mounting Filesystems</a></li> -->
              <!-- <li class="sidebar-nav-item"><a href="/finch/mounting-filesystems">Mounting Filesystems</a></li> -->
              <!-- <li><a href="/finch/portsnap_override-8">Portsnap_override 8</a></li> -->
              <!-- <li class="sidebar-nav-item"><a href="/finch/portsnap_override-8">Portsnap_override 8</a></li> -->
              <!-- <li><a href="/finch/qjail-reference">Qjail Reference</a></li> -->
              <!-- <li class="sidebar-nav-item"><a href="/finch/qjail-reference">Qjail Reference</a></li> -->
              <!-- <li><a href="/finch/support">Support</a></li> -->
              <!-- <li class="sidebar-nav-item"><a href="/finch/support">Support</a></li> -->
              <!-- <li><a href="/finch/upgrading">Upgrading</a></li> -->
              <!-- <li class="sidebar-nav-item"><a href="/finch/upgrading">Upgrading</a></li> -->
              <!-- <li class="active"><a href="/finch/usage" class="active">Usage</a></li> -->
              <!-- <li class="sidebar-nav-item-active"> -->
              <!-- <li>
                <a href="/finch/usage" class="sidebar-nav-item-active">Usage</a>
              </li> -->
    
              <!-- <a href="https://github.com/dreamcat4/finch/issues">Bugtracker</a> -->
    
                <!-- <li class="sidebar-nav-item{% if page.url == node.url %} active{% endif %}"> -->
    
    
    
                  <!-- <a href=""></a> -->
    
                  <!-- 
                    
                      <li><a href="/finch/faq">FAQ</a></li>
                    
                  
                    
                      <li><a href="/finch/finch-8">Finch 8</a></li>
                    
                  
                    
                      <li><a href="/finch">Index</a></li>
                    
                  
                    
                      <li><a href="/finch/install">Install</a></li>
                    
                  
                    
                      <li><a href="/finch/jails-how-to">Jails How To</a></li>
                    
                  
                    
                      <li><a href="/finch/jails-ip-addresses">Jails Ip Addresses</a></li>
                    
                  
                    
                      <li><a href="/finch/jails-ssh">Jails Ssh</a></li>
                    
                  
                    
                      <li><a href="/finch/manpage">Manpage</a></li>
                    
                  
                    
                      <li><a href="/finch/mounting-filesystems">Mounting Filesystems</a></li>
                    
                  
                    
                      <li><a href="/finch/portsnap_override-8">Portsnap_override 8</a></li>
                    
                  
                    
                      <li><a href="/finch/qjail-reference">Qjail Reference</a></li>
                    
                  
                    
                      <li><a href="/finch/support">Support</a></li>
                    
                  
                    
                      <li><a href="/finch/upgrading">Upgrading</a></li>
                    
                  
                      <li class="active"><a href="/finch/usage" class="active">Usage</a></li>
                    
                    
                   -->
    
    
                </li>
              <!-- {% endif %}
            {% endif %}
          {% endfor %} -->
    
          <!-- <li class="sidebar-nav-item"><a href="dreamcat4/finch/archive/v.zip">Download</a></li> -->
          <!-- <li class="sidebar-nav-item"><a href="https://github.com/dreamcat4/finch">GitHub Project</a></li> -->
          <!-- <li class="sidebar-nav-item">Currently v</li> -->
    
          <!-- <li class="sidebar-nav-item"><a href="https://github.com/dreamcat4/finch">GitHub Project</a></li> -->
          
          <p></p>
          <!-- <p></p> -->
        </ul>
        <!-- <p> -->
        <p>
          <!-- <class="crumbline" style="color: #515151; font-size: 16px; font-style: italic; font-weight: 400;" href="https://github.com/dreamcat4/finch">GitHub Project</a> -->
          <!-- <a class="sidebar-nav" class="crumbline" style="color: #515151; font-size: 16px; font-style: italic; font-weight: 400;" href="https://github.com/dreamcat4/finch">GitHub Project</a> -->
    
          <!-- <a class="sidebar-nav" class="crumbline" style="color: #515151; font-size: 16px; font-style: italic; font-weight: 400;" href="#toc_0">Back to Top</a> -->
    
          <a class="sidebar-nav" class="crumbline" style="color: #515151; font-size: 16px; font-style: italic; font-weight: 400;" href="/finch/usage">Back to Top</a>
    
          <!-- Â© 2014. All rights reserved. -->
        </p>
    
        <!-- <p>&copy; {--{ site.time | date: '%Y' }--}. All rights reserved.</p> -->
      </div>
    </div>
    

    <div class="navbar">
      <div class="navbar-inner">
        <!-- <div class="container-narrow"> -->
          <!-- <a class="brand" href="/finch/">Finch</a> -->
    
          <!-- <p class="navbar-left"> -->
          <div class="navbar-left">
    
            <!-- Project hosted on Github <a href="https://github.com/dreamcat4/finch">dreamcat4/finch</a> -->
    
            <ul class="nav">
                  <li><a href="/finch">Home</a></li>
    
                
                  <li><a href="/finch/manpage">Manpage</a></li>
                
                
                  <li><a href="/finch/install">Install</a></li>
                
                
                  <li><a href="/finch/faq">FAQ</a></li>
                
    
            </ul>
    
          <!-- </p> -->
          </div>
    
    
          <!-- <p class="footer-center">
          </p> -->
    
          <!-- <p class="navbar-right"> -->
          <div class="navbar-right">
    
            <!-- &copy; Dreamcat4 2014,  -->
            <!-- FreeBSD Licensing terms. -->
    
    
            <ul class="nav">
    
                
                  <li><a href="/finch/jails-how-to">Jails How To</a></li>
                
                
                  <li><a href="/finch/upgrading">Upgrading</a></li>
                
                
                  <li><a href="/finch/support">Support</a></li>
                
    
              <!--  -->
    
              <!-- 
                
                  <li><a href="/finch/faq">FAQ</a></li>
                
              
                
                  <li><a href="/finch/finch-8">Finch 8</a></li>
                
              
                
                  <li><a href="/finch">Index</a></li>
                
              
                
                  <li><a href="/finch/install">Install</a></li>
                
              
                
                  <li><a href="/finch/jails-how-to">Jails How To</a></li>
                
              
                
                  <li><a href="/finch/jails-ip-addresses">Jails Ip Addresses</a></li>
                
              
                
                  <li><a href="/finch/jails-ssh">Jails Ssh</a></li>
                
              
                
                  <li><a href="/finch/manpage">Manpage</a></li>
                
              
                
                  <li><a href="/finch/mounting-filesystems">Mounting Filesystems</a></li>
                
              
                
                  <li><a href="/finch/portsnap_override-8">Portsnap_override 8</a></li>
                
              
                
                  <li><a href="/finch/qjail-reference">Qjail Reference</a></li>
                
              
                
                  <li><a href="/finch/support">Support</a></li>
                
              
                
                  <li><a href="/finch/upgrading">Upgrading</a></li>
                
              
                  <li class="active"><a href="/finch/usage" class="active">Usage</a></li>
                
                
               -->
            </ul>
    
          <!-- </p> -->
          </div>
    
        <!-- </div> -->
      </div>
    </div>
    

    <div class="logo"></div>

    <div class="container-narrow">

      <div class="content">
        <h1 id="toc_0">Using Finch</h1>

<p><ul>
<li>
<a href="#toc_0">Using Finch</a>
<ul>
<li>
<a href="#toc_1">User Setup</a>
</li>
<li>
<a href="#toc_2">Finch&#39;s shell prompt</a>
</li>
<li>
<a href="#toc_3">How to &#39;su&#39; and preserve Finch&#39;s login profile</a>
</li>
<li>
<a href="#toc_4">Enter / exit the finch chroot</a>
</li>
<li>
<a href="#toc_5">Other &#39;finch&#39; sub-commands</a>
</li>
<li>
<a href="#toc_6">Read the manpages</a>
</li>
<li>
<a href="#toc_7">Finch exports</a>
</li>
<li>
<a href="#toc_8">Refreshing &#39;/etc&#39; files</a>
</li>
</ul>
</li>
</ul>
</p>

<h2 id="toc_1">User Setup</h2>

<ul>
<li>Set your user account to be a member of group <code>wheel</code>. <sup>1</sup></li>
<li>It is recommended to set <code>bash</code> to be your user login shell <sup>2</sup></li>
<li>Issue a <a href="#toc_8"><code>finch refresh</code></a> after changing users or groups.</li>
</ul>

<p><sup>1</sup> Only members of the <code>wheel</code> administrative group can use Finch. For more information please see the finch <a href="/finch/manpage#USAGE">manpage</a>. <sup>2</sup> Always use a POSIX.2 or Bourne-type compatible shell. Finch installs Bash by default. For more information please see the <a href="/finch/faq/#toc_8">bash FAQ entry</a>.</p>

<h2 id="toc_2">Finch&#39;s shell prompt</h2>

<p>There are 3 different Finch prompts. They tell you in a logical manner which of the following 3 environments you are currently in. Requires <code>bash</code> or <code>sh</code> shell, which use <code>PS1</code> for the prompt variable. The file <code>. /etc/profile</code> must sourced.</p>

<ul>
<li><p>Host environment, <em>e.g. FreeNAS, NAS4Free, pfSense</em>:
</br><strong><div><code class="custom-code"><span class="mar">hostname</span> <span class="pur">dir</span><span class="blk">/</span> <span class="blk">user</span><span class="mar">~$</span></code></div></strong></p></li>
<li><p>Finch chroot environment:
</br><strong><div><code class="custom-code"><span class="mar">hostname</span> <span class="pur">dir</span><span class="blk">/</span> <span class="blk">user</span><span class="mar">^&gt;</span></code></div></strong></p></li>
<li><p>Inside a jail:
</br><strong><div><code class="custom-code"><span class="grn">jailname</span> <span class="pur">dir</span><span class="blk">/</span> <span class="blk">user</span><span class="grn">~#</span></code></div></strong></p></li>
</ul>

<p><strong><em>Prompt components:</em></strong></p>

<ul>
<li><strong>Hostname</strong> - (or jailname, which is also the jail&#39;s hostname), critically tells you which machine the window is logged into. This is crucial in multi-host environments.</li>
<li><strong>Dir</strong> - (directory), is an important indicator. For brevity we only print the last path component rather than the full path. Since 99% of the time that is enough information. If it&#39;s not then just type <code>pwd</code> to see the full path.</li>
<li><strong>User</strong> - the username of the current login. Used to determine whether or not you&#39;re <code>root</code>.</li>
</ul>

<p><strong><em>Styling and color scheme:</em></strong></p>

<ul>
<li><strong>Host</strong> - In the host, we use a standard and non-descript shell prompt <code>~$</code>.</li>
<li><strong>Finch</strong> - The &quot;pecking beack&quot; symbol <code>^&gt;</code> is a literal representation of the Finch project&#39;s avian-themed logo.</li>
<li><strong>Jail</strong> - Finally we use the hash <code>~#</code> symbol to identify a jail, simply because it looks like the bars of a jail. The green color is also applied to jails, being the color scheme of the Qjail project&#39;s website. Green also highlights the protected and sandboxed nature of a jail environment.</li>
</ul>

<h2 id="toc_3">How to &#39;su&#39; and preserve Finch&#39;s login profile</h2>

<pre><code># Assuming a bash shell
sudo su -l

# Or with /bin/sh
sudo su
. /etc/profile
</code></pre>

<h2 id="toc_4">Enter / exit the finch chroot</h2>

<p>Most times, we just need to switch in and out of the finch chroot. This is very simple, just type:</p>

<pre><code>finch chroot
exit
</code></pre>

<p>To do the same thing, but also become the root user:</p>

<pre><code>sudo finch chroot
exit
</code></pre>

<p>And that&#39;s all there is to it.</p>

<h2 id="toc_5">Other &#39;finch&#39; sub-commands</h2>

<pre><code>finch:
     Access the Finch FreeBSD chroot environment. `man finch` for more info.

Usage:
     $ finch &lt;command&gt; [args]

Commands:

     chroot    - Chroot into Finch FreeBSD (`chroot /path/to/finch`).
     start     - Mount Finch and start it&#39;s rc.d services.
     stop      - Stop Finch&#39;s rc.d services and unmount &quot;finch/dev&quot;.
     restart   - Same as `finch stop` followed by `finch start`.
     status    - Report on Finch service status (enabled/disabled).
     export    - Map a new command into Finch exports (`finch export &lt;cmd&gt;`).
     -export   - Remove a command from Finch exports (`finch -export &lt;cmd&gt;`).
     &lt;export&gt;  - Run a command listed in Finch exports (`finch &lt;export&gt;`).
     update    - Update the Finch scripts (this program) to the latest version.
     refresh   - Refresh /finch/etc/ files (resolv.conf, localtime &amp; passwd).
     bootstrap - Run the curl-based online installation script `finch-bootstrap`.
     realpath  - The real path to Finch (&quot;$finch_realpath&quot;, &quot;/path/to/finch&quot;).
     --version - Print the current version of Finch and exit.
     -h,--help - Display this message and exit.

Realpath:
     /mnt/disk0/finch

Exports:
     man, pkg, qjail

Version:
     1.00b, 2180681d76, Fri Mar 21 19:32:06 GMT 2014.

Bugs:
     Can be reported at http://dreamcat4.github.io/finch/support

Created by:
     Dreamcat4, dreamcat4@gmail.com (C 2014). FreeBSD License.
</code></pre>

<h2 id="toc_6">Read the manpages</h2>

<pre><code># Learn about finch
man finch

# Learn about qjail
man qjail
</code></pre>

<h2 id="toc_7">Finch exports</h2>

<ul>
<li>Finch exports are a way to auto-chroot for certain frequently-used commands (for example <code>qjail</code>).</li>
<li>We call such commands <code>exports</code> because they are &quot;exports&quot; of Finch into the host&#39;s shell environment.</li>
<li>Exports are just a convenience. You can run any command with <code>finch chroot &lt;cmd&gt;</code>. Even if it isn&#39;t in Finch&#39;s exports list.</li>
<li>Bear in mind: whilst inside the chroot, the FreeBSD host environment and root tree are inaccessible. It is worth remembering.</li>
<li>Exports are maintained as a folder of symlinks. Location: <code>$finch_realpath/etc/finch/exports/</code>.</li>
<li>If a command already exists in the host environment, then that will take higher priority and be executed instead. Because it comes first on the search path <code>$PATH</code>. For example: <code>pkg</code>.</li>
<li>An INTERACTIVE shell will source <code>/etc/profile</code>, and set the finch exports directory onto your $PATH statement.</li>
<li>Another way to run exports is with <code>finch &lt;export&gt;</code>. Doing so explicitly will ensure that the command is only searched for inside the Finch chroot (and not the host&#39;s shell also).</li>
<li>As with all Finch, we rely upon FreeBSD&#39;s <code>chroot</code> C program. Only the root user, or members of group &quot;wheel&quot; can run Finch commands... so that also includes Finch&#39;s &quot;exports&quot;.</li>
</ul>

<h2 id="toc_8">Refreshing &#39;/etc&#39; files</h2>

<p>It is necessary to refresh certain <code>/etc</code> files in the Finch system if they have changed in the host system such as:</p>

<ul>
<li>DNS settings in <code>/etc/resolv.conf</code></li>
<li>Time zone setting in <code>/etc/localtime</code></li>
<li>Adding or modifying user accounts.</li>
<li>Adding or modifying user groups.</li>
</ul>

<p>Just issue a <code>finch refresh</code>, <code>finch restart</code>, or reboot your host system.</p>

      </div>

      <!-- last linebreak for manpage -->
      <p style="line-height: 0px;">&nbsp;</p> 

      <div class="footer">
        <hr class="footer-hr">
      
        <!-- order is backwards b/c footer-left style isnt loaded -->
        <div class="footer-left" style="float: left; position: absolute;">
          <!-- Project hosted on Github <a href="https://github.com/dreamcat4/finch">dreamcat4/finch</a> -->
          Project hosted on Github @ <a href="https://github.com/dreamcat4/finch">dreamcat4/finch</a>.
        </div>
        <div class="footer-right" style="float: right; position: relative;">
          &copy; Dreamcat4 2014, 
           FreeBSD License.
        </div>
      
        <div style="clear: both;"></div>â
      </div>
      

    </div> <!-- /container -->

    <!-- Google Prettify -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
<script>
  var pres = document.getElementsByTagName("pre");
  for (var i=0; i < pres.length; ++i) {
    pres[i].className = "prettyprint ";
  }
  prettyPrint();
</script>
<!-- end Google Prettify -->
    
    
  </body>
</html>
